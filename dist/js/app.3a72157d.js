(function(){"use strict";var e={4398:function(e,t,s){var o=s(8935),a=function(){var e=this,t=e.$createElement,s=e._self._c||t;return s("div",{attrs:{id:"app"}},[s("icon-chatbot",{attrs:{initOpenProp:!1}})],1)},n=[],i=function(){var e=this,t=e.$createElement,o=e._self._c||t;return o("div",[o("div",{staticClass:"open-chat",class:e.isOpen?"hide":"show",on:{click:e.toggleChatOpen}},[o("img",{staticClass:"imgIcon",attrs:{src:s(8642),alt:"ICONO"}})]),o("div",{staticClass:"chat-container",class:e.isOpen?"show":"hide"},[o("div",{staticClass:"chat-window"},[o("div",{staticClass:"close-chat",style:{background:e.iconColorProp},on:{click:e.toggleChatOpen}},[o("svg",{attrs:{xmlns:"http://www.w3.org/2000/svg",viewBox:"0 0 60 60"}},[o("g",{attrs:{fill:"none",stroke:"#ffffff","stroke-width":"10","stroke-miterlimit":"10","stroke-linecap":"round"}},[o("path",{attrs:{d:"M10 10l45 45M10 55l45-45"}})])])]),o("div",{staticClass:"chat-header",style:{background:e.messageHeaderColorProp}},[o("h1",{staticClass:"imgTitle",attrs:{id:"title"}},[e._v("virtual assist")])]),o("div",{staticClass:"chat-header-mobile",style:{background:e.messageHeaderColorPropMobile}},[o("svg",{staticClass:"minimizeButton",attrs:{xmlns:"http://www.w3.org/2000/svg",viewBox:"0 0 60 60"},on:{click:e.toggleChatOpen}},[o("g",{attrs:{fill:"none",stroke:"#ffffff","stroke-width":"10","stroke-miterlimit":"10","stroke-linecap":"round"}},[o("path",{attrs:{d:"M10 10l45 45M10 55l45-45"}})])])]),o("div",{ref:"chatArea",staticClass:"chat-area",style:{background:e.messageBackgroundColorProp},attrs:{id:"panelChat"}},e._l(e.messages,(function(t){return o("div",{key:t.id||t.body},[o("v-col",{class:{"col-out":"you"===t.author,"col-in":"you"!==t.author}},[o("v-row",{class:{"row-out":"you"===t.author,"row-in":"you"!==t.author}},["text"!==t.type||t.body.includes("http")?e._e():o("div",{ref:"mensajes",refInFor:!0,staticClass:"message",class:{"message-out":"you"===t.author,"message-in":"you"!==t.author},style:["you"===t.author?{background:e.messageOutColorProp}:{background:e.messageInColorProp}]},[o("span",{ref:"spanMensajes",refInFor:!0,staticClass:"spanMensajes"},[e._v(e._s(t.body))])]),"audio"===t.type?o("audio",{class:{"audio-out":"you"===t.author,"audio-in":"you"!==t.author},attrs:{controls:"controls",width:"20%",controlsList:"nodownload"}},[o("source",{attrs:{src:t.src}})]):e._e(),"button"===t.type?o("v-btn",{key:t.id,staticClass:"messageButton",class:{"message-out":"you"===t.author,"message-in":"you"!==t.author},attrs:{id:t.id,elevation:"2",color:"#eae8ea",rounded:""},on:{click:function(s){return e.optionSelected(t.body)}}},[e._v(e._s(t.body)+" ")]):e._e(),"text"===t.type&&t.body.includes("http")?o("div",{staticClass:"message",class:{"message-out":"you"===t.author,"message-in":"you"!==t.author},style:["you"===t.author?{background:e.messageOutColorProp}:{background:e.messageInColorProp}]},[o("a",{attrs:{target:"_blank",href:t.body}},[e._v(e._s(t.body))])]):e._e()],1)],1)],1)})),0),o("div",{staticClass:"chat-input"},[o("form",{staticClass:"chat-form",on:{submit:function(t){return t.preventDefault(),e.qyr()}}},[o("vue-record-audio",{attrs:{mode:"press"},on:{result:e.onResult,stream:e.mic}}),o("input",{directives:[{name:"model",rawName:"v-model",value:e.youMessage,expression:"youMessage"}],staticClass:"inputMessage",attrs:{type:"text",placeholder:e.messagePlaceholder,autofocus:""},domProps:{value:e.youMessage},on:{input:function(t){t.target.composing||(e.youMessage=t.target.value)}}}),o("button",{staticClass:"submit",attrs:{type:"submit"}},[o("feather-icon",{style:{color:e.iconColorProp,width:"25px"},attrs:{name:"send","base-class":"icon-send-message"}})],1)],1)])])])])},r=[],l=s(1063),c=s(8772),u=s.n(c),h=s(6166),d=s.n(h),g=s(4029),p=s.n(g);o["default"].use(l.Z,"feather-icon"),o["default"].use(u());var f={sockets:{connect:function(){console.log("Conectado")},customEmit:function(){console.log("Enviar cosas")}},props:{messagePlaceholder:{type:String,default:"Type here..."},iconColorProp:{type:String,default:"#00316b"},messageBackgroundColorProp:{type:String,default:"#ffffff"},messageHeaderColorProp:{type:String,default:"#00316b"},messageHeaderColorPropMobile:{type:String,default:"#00316b"},messageOutColorProp:{type:String,default:"#00316b"},messageButton:{type:String,default:"#00316b"},messageInColorProp:{type:String,default:"#f1f0f0"},initOpenProp:Boolean},data:()=>({youMessage:"",isOpen:!1,messages:[],recognition:null,isMicActive:!1,audioToText:"",idChat:0,spanWidth:0}),methods:{onResult(e){var t=this;this.recognition.stop(),console.log("stop"),this.recognition.onresult=function(e){var s=e.resultIndex,o="";o=e.results[s][0].transcript,this.audioToText+=o,console.log(this.audioToText),t.$emit("listened",this.audioToText)};var s=window.URL.createObjectURL(e);this.messages.push({body:this.youMessage,author:"you",date:new Date,type:"audio",src:s,id:this.messages.length}),this.messageScroll()},optionSelected(e){this.$emit("optClicked",e)},mic(){this.recognition.start(),console.log("Voice recognition activated. Try speaking into the microphone.")},sendToBack(e,t){this.$socket.emit(t,e)},qyr(){this.handleOutboundMessage(),this.messageScroll()},handleOutboundMessage(){this.youMessage&&(this.youMessage.trim().length>0&&this.messages.push({body:this.youMessage,author:"you",date:new Date,type:"text",src:null,id:this.messages.length}),this.messageScroll(),this.$nextTick((()=>{this.sendToBack({message:this.youMessage,nick:"you"},"chat-message"),this.sockets.subscribe("chat-emit",(e=>{this.messages.push({body:e.message,author:"bot",date:new Date,type:"text",src:null,id:this.messages.length}),e.opts&&e.opts.length>0&&e.opts.forEach((e=>{this.messages.push({body:e,author:"bot",date:new Date,type:"button",src:null,id:this.messages.length})})),p()("#panelChat").animate({scrollTop:p()("#panelChat")[0].scrollHeight},1e3)})),this.messageScroll(),this.youMessage="",this.messageScroll()})),this.sockets.unsubscribe("chat-emit"),this.$nextTick((()=>{console.log(this.messages[this.messages.length-1]),this.messageScroll()})))},toggleChatOpen(){this.isOpen=!this.isOpen,this.$emit("onToggleOpen",this.isOpen)},messageScroll(){let e=this.$refs.chatArea;e.scrollTop=e.scrollHeight}},mounted(){try{var e=window.SpeechRecognition||window.webkitSpeechRecognition;this.recognition=new e}catch(a){console.error(a)}this.isOpen=this.initOpenProp||!1;let t={name:"a",createdAt:"2021-09-28",updatedAt:"2021-09-28",origin:0};d().post("http://localhost:8080/api/chat/create",t).then((e=>{console.log(e.data),this.idChat=e.data.id,console.log(this.idChat)})),this.messages.push({body:"Hi! How are you? Thank you for agreeing to talk to me. Could you rate your tourist experience in Ireland? It will be a short questionnaire",author:"bot",date:new Date,type:"text",src:null,id:this.messages.length}),this.sendToBack({message:"Hi! How are you? Thank you for agreeing to talk to me. Could you rate your tourist experience in Ireland? It will be a short questionnaire",nick:"Bot"},"chat-message"),this.messageScroll();var s=document.getElementsByClassName("chat-container")[0],o=window.innerHeight;s.style.height=o;this.$on("listened",(e=>{console.log("recibido"),this.youMessage=e.replace("undefined",""),this.qyr()})),this.$on("optClicked",(e=>{console.log("recibido"),this.youMessage=e,this.qyr()})),this.sockets.subscribe(`chat-message${this.idChat}`,(e=>{console.log("Data: ",e)}))}},m=f,y=s(1001),b=(0,y.Z)(m,i,r,!1,null,"142f5864",null),v=b.exports,C={name:"App",components:{IconChatbot:v}},w=C,k=(0,y.Z)(w,a,n,!1,null,null,null),O=k.exports,x=s(8209),M=s.n(x),T=(s(243),s(1950)),P=s.n(T);o["default"].use(M()),o["default"].use(new(P())({debug:!0,connection:"http://localhost:8080/",vuex:{actionPrefix:"SOCKET_",mutationPrefix:"SOCKET_"}})),o["default"].config.productionTip=!1,new o["default"]({render:e=>e(O)}).$mount("#app")},8642:function(e,t,s){e.exports=s.p+"img/chatbot.f82cbe73.png"}},t={};function s(o){var a=t[o];if(void 0!==a)return a.exports;var n=t[o]={exports:{}};return e[o].call(n.exports,n,n.exports,s),n.exports}s.m=e,function(){var e=[];s.O=function(t,o,a,n){if(!o){var i=1/0;for(u=0;u<e.length;u++){o=e[u][0],a=e[u][1],n=e[u][2];for(var r=!0,l=0;l<o.length;l++)(!1&n||i>=n)&&Object.keys(s.O).every((function(e){return s.O[e](o[l])}))?o.splice(l--,1):(r=!1,n<i&&(i=n));if(r){e.splice(u--,1);var c=a();void 0!==c&&(t=c)}}return t}n=n||0;for(var u=e.length;u>0&&e[u-1][2]>n;u--)e[u]=e[u-1];e[u]=[o,a,n]}}(),function(){s.n=function(e){var t=e&&e.__esModule?function(){return e["default"]}:function(){return e};return s.d(t,{a:t}),t}}(),function(){s.d=function(e,t){for(var o in t)s.o(t,o)&&!s.o(e,o)&&Object.defineProperty(e,o,{enumerable:!0,get:t[o]})}}(),function(){s.g=function(){if("object"===typeof globalThis)return globalThis;try{return this||new Function("return this")()}catch(e){if("object"===typeof window)return window}}()}(),function(){s.o=function(e,t){return Object.prototype.hasOwnProperty.call(e,t)}}(),function(){s.r=function(e){"undefined"!==typeof Symbol&&Symbol.toStringTag&&Object.defineProperty(e,Symbol.toStringTag,{value:"Module"}),Object.defineProperty(e,"__esModule",{value:!0})}}(),function(){s.p="/"}(),function(){var e={143:0};s.O.j=function(t){return 0===e[t]};var t=function(t,o){var a,n,i=o[0],r=o[1],l=o[2],c=0;if(i.some((function(t){return 0!==e[t]}))){for(a in r)s.o(r,a)&&(s.m[a]=r[a]);if(l)var u=l(s)}for(t&&t(o);c<i.length;c++)n=i[c],s.o(e,n)&&e[n]&&e[n][0](),e[n]=0;return s.O(u)},o=self["webpackChunkvue_chat"]=self["webpackChunkvue_chat"]||[];o.forEach(t.bind(null,0)),o.push=t.bind(null,o.push.bind(o))}();var o=s.O(void 0,[998],(function(){return s(4398)}));o=s.O(o)})();
//# sourceMappingURL=app.3a72157d.js.map